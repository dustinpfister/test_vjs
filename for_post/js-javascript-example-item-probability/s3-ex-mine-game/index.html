<html>
    <head>
        <title>Item Probability</title>
    </head>
    <body>
        <!--<canvas id="the-canvas" width="640" height="480"></canvas>-->

        <input id="mine_manual" type="button" value="mine">

        <script src="../s1-item-class/item-class.js"></script>
        <script>

var ORES = {
    oreJunk: ['copper', 'iron'],
    oreCommon: ['zink', 'lead']
};

// create and return an itemClass object for the given map
// using itemClass.create
var getItemClassObj = function(mine){
    // creating a item classes object
    return itemClass.create({
       levelPer: (mine.level - 1) / (mine.maxLevel -1),
       levelPerRatio: 0.5,
       pool: mine.oreClasses
    });
};

var createMine = function(){
    var mine = {
        level: 1,
        maxLevel: 10,
        oreCounts: {},
        oreClasses: [
            {desc: 'oreJunk', range: [1000, 1000], levelPer: 1},
            {desc: 'oreCommon', range: [50, 600], levelPer: 0}
        ],
        itemClassObj: null
    };
    Object.keys(ORES).forEach(function(oreClassKey){
       ORES[oreClassKey].forEach(function(oreKey){
           mine.oreCounts[oreKey] = 0;
       });
    });
    mine.itemClassObj = getItemClassObj(mine);
    return mine;
};

var singleStrike = function(mine){
    var classObj = itemClass.getRandomItemClass(mine.itemClassObj),
    oreList = ORES[classObj.desc],
    oreKey = oreList[ Math.floor( Math.random() * oreList.length ) ];
    mine.oreCounts[oreKey] += 1;
	console.log(mine.oreCounts);
};

var mine = createMine();

console.log(mine);

document.getElementById('mine_manual').addEventListener('click', function(e){
   singleStrike(mine);
});

// DEMO
//var canvas = document.getElementById('the-canvas'),
//ctx = canvas.getContext('2d');

        </script>
    </body>
</html>