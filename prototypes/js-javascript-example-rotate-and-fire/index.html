<html>
    <head>
        <title>javaScript example item object</title>
    </head>
    <body>
        <div id="canvas-app"></div>
        <script>

var utils = {};

// mathematical modulo
utils.mod = function (x, m) {
    return (x % m + m) % m;
};

utils.normalizeHalf = function (n, scale) {
    var c = scale || Math.PI * 2,
    h = c / 2;
    return utils.mod(n + h, c) - h;
};

// the angular distance between two angles
utils.angleDistance = function (a, b, scale) {
    var m = scale || Math.PI * 2,
    h = m / 2,
    diff = utils.normalizeHalf(a - b, scale);
    if (diff > h) {
        diff = diff - m;
    }
    return Math.abs(diff);
};

// get -1, 1, or 0 depending on the the state of two angles
utils.shortestAngleDirection = function (a1, a2, scale) {
    var z = a1 - a2,
    x = utils.normalizeHalf(z, scale);
    if (x < 0) {
        return -1; // Left
    }
    if (x > 0) {
        return 1; // Right
    }
    // if a1 === a2 or any other case
    return 0;
};

var canvas = document.createElement('canvas'),
ctx = canvas.getContext('2d');

document.getElementById('canvas-app').appendChild(canvas);

canvas.width = 320;
canvas.height = 240;

var draw = {};

draw.back = function(ctx, canvas){
    ctx.fillStyle = 'black';
    ctx.fillRect(0, 0, canvas.width, canvas.height);
};

draw.turret = function(ctx, state){
    var turret = state.turret;
    ctx.save();
    ctx.translate(turret.x, turret.y);
    ctx.fillStyle = 'yellow';
    ctx.fillRect(turret.w * 0.5 * -1, turret.h * 0.5 * -1, turret.w, turret.h);
    ctx.rotate(turret.facing);
    ctx.fillStyle = 'red';
    ctx.strokeStyle = 'red';
    ctx.fillRect(turret.w * 0.3 * -1, turret.h * 0.3 * -1, turret.w * 0.6, turret.h * 0.6);
    ctx.beginPath();
    ctx.moveTo(0, 0);
    ctx.lineTo(turret.w, 0);
    ctx.stroke();
    ctx.restore();
};

var state = {
    turret: {
        x: canvas.width / 2,
        y: canvas.height / 2,
        w: 32,
        h: 32,
        facing: 1.57,
        target : 0,
        radiansPerSecond: Math.PI / 180 * 20,
        heading: Math.PI * 1.5
    }
};

// update turret facing to face current target
var updateTurretFacing = function(state, secs){
    var turret = state.turret
    var dist = utils.angleDistance(turret.facing, turret.target);
    var dir = utils.shortestAngleDirection(turret.target, turret.facing);
    var delta = turret.radiansPerSecond * secs;
    if(delta > dist){
        turret.facing = turret.target;
    }else{
        turret.facing += delta * dir;
    }
};

var lt = new Date();
var loop = function(){
    var now = new Date(),
    secs = (now - lt) / 1000;
    requestAnimationFrame(loop);

    updateTurretFacing(state, secs);

    draw.back(ctx, canvas);
    draw.turret(ctx, state);
    lt = now;
};
loop();

        </script>
    </body>
</html>