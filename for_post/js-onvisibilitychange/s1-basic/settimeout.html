<html>
    <head>
        <title>App Loop Demo</title>
    </head>
    <body>
        <script>
var state = {
   fps: 0,
   secs: 0,
   lt: new Date()
};
// draw method
var drawTitle = function(state){
    document.title = 'fps: ' + state.fps;
};
// update method
var update = function(state){
   var now = new Date();
   state.secs = (now - state.lt) / 1000;
   state.fps = 1 / state.secs;
   // update fps value
   state.fps = state.fps < 1 ? state.fps.toFixed(2) : Math.floor(state.fps);
   state.lt = now;
};
// on visibility change event
document.addEventListener("visibilitychange", function(){
});
// app loop using setTimeout
var loop = function(){
    setTimeout(loop, 33);
    update(state);
    drawTitle(state);
};
loop(); // call update for first time
        </script>
    </body>
</html>